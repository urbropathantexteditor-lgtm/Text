<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ur bro pathan — Stylish Text Generator</title>
<style>
:root{--bg:#0b0b0b;--card:#0f0f0f;--muted:#94a3b8;--accent:#10b981;--glass:#1a1a1a}
body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;color:#f1f5f9;background:var(--bg);display:flex;justify-content:center;padding:8px}
.app{width:100%;max-width:100%;}
header{display:flex;align-items:center;justify-content:flex-start;margin-bottom:8px;padding:0 8px}
.logo{width:36px;height:36px;border-radius:8px;background:linear-gradient(135deg,#06b6d4,#7c3aed);display:flex;align-items:center;justify-content:center;font-weight:700;color:white;margin-right:8px}
h1{font-size:18px;margin:0}
.small{font-size:12px;color:var(--muted)}
.card{background:var(--card);border-radius:10px;padding:10px;margin-bottom:8px;box-shadow:0 4px 12px rgba(2,6,23,0.6)}
textarea{width:100%;min-height:70px;padding:8px;border-radius:6px;background:var(--glass);border:none;color:white;font-size:14px;resize:vertical}
.styles{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:6px;max-height:50vh;overflow:auto;padding:4px}
.style{background:var(--glass);padding:8px;border-radius:8px;cursor:pointer;text-align:center;min-height:40px;display:flex;align-items:center;justify-content:center;word-break:break-word;transition:transform .12s,background .12s}
.style:hover{transform:translateY(-2px);background:#243343}
.btn{background:var(--accent);color:#06201b;padding:6px 10px;border-radius:6px;border:none;cursor:pointer;font-weight:600;font-size:13px}
.btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
.overlay{position:fixed;inset:0;background:rgba(0,0,0,0.8);display:flex;align-items:center;justify-content:center;z-index:2000}
.loginModal{background:#111;padding:20px;border-radius:12px;width:90%;max-width:320px;text-align:center}
input{padding:6px;border-radius:6px;border:none;background:rgba(255,255,255,0.03);color:white;flex:1}
</style>
</head>
<body>
<div class="app">
  <header>
    <div class="logo">PB</div>
    <h1>ur bro pathan</h1>
  </header>

  <div class="card">
    <div class="small">Coins: <span id="coinCount">6</span></div>
  </div>

  <div class="card">
    <div class="small">Apply a coupon code:</div>
    <div style="display:flex;gap:6px;margin-top:6px">
      <input id="applyCoupon" placeholder="Enter coupon code"/>
      <button id="applyCouponBtn" class="btn">Apply</button>
    </div>
    <div class="small" id="couponMsg" style="margin-top:4px;color:var(--muted)"></div>
  </div>

  <div class="card">
    <div class="small" style="margin-bottom:6px">Type text below — click a style to copy (costs 2 coins):</div>
    <textarea id="input">Hello from ur bro pathan</textarea>
  </div>

  <div class="card">
    <div class="styles" id="stylesList"></div>
  </div>
</div>

<div id="overlay" class="overlay">
  <div class="loginModal">
    <h3>Login Required</h3>
    <div class="small" style="margin:8px 0">Sign in with Google to generate text and use coupons.</div>
    <button id="overlayLogin" class="btn" style="width:100%">Login with Google</button>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithRedirect, getRedirectResult, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
import { getDatabase, ref, get, set, update, runTransaction } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

// ----------------- FIREBASE -----------------
const firebaseConfig = {
  apiKey: "AIzaSyDFPMf8HLMpS6DbZkdCR6T7GAm5sfz-TOw",
  authDomain: "urbrokhan-f631c.firebaseapp.com",
  databaseURL: "https://urbrokhan-f631c-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "urbrokhan-f631c",
  storageBucket: "urbrokhan-f631c.appspot.com",
  messagingSenderId: "533086015351",
  appId: "1:533086015351:web:a12328fbc4906e4f5c9b72"
};
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getDatabase(app);
const provider = new GoogleAuthProvider();

// ----------------- ELEMENTS -----------------
const overlay = document.getElementById('overlay');
const overlayLogin = document.getElementById('overlayLogin');
const coinCountEl = document.getElementById('coinCount');
const applyCouponInput = document.getElementById('applyCoupon');
const applyCouponBtn = document.getElementById('applyCouponBtn');
const couponMsg = document.getElementById('couponMsg');
const inputEl = document.getElementById('input');
const stylesList = document.getElementById('stylesList');

let currentUser = null;
let currentUid = null;

// ----------------- COUPONS -----------------
let validCoupons = { "WELCOME10":10, "URBRO20":20, "BONUS5":5 };

// ----------------- USER HELPERS -----------------
async function ensureUser(uid,email,name){
  const uref = ref(db,'users/'+uid);
  const snap = await get(uref);
  if(!snap.exists()){
    await set(uref,{ email: email||'', displayName: name||'', coins:6 });
  }
}
async function refreshUser(){
  if(!currentUid) return;
  const snap = await get(ref(db,'users/'+currentUid));
  const data = snap.exists()? snap.val(): {coins:6};
  coinCountEl.textContent = data.coins||6;
}

// ----------------- LOGIN -----------------
overlayLogin.addEventListener('click', ()=> signInWithRedirect(auth,provider));

getRedirectResult(auth)
.then(result=>{
  if(result.user){
    currentUser = result.user;
    currentUid = result.user.uid;
  }
}).catch(console.error);

onAuthStateChanged(auth, async user=>{
  if(user){
    currentUser = user;
    currentUid = user.uid;
    overlay.style.display = 'none';
    await ensureUser(user.uid,user.email,user.displayName);
    await refreshUser();
    renderStyles();
  } else {
    overlay.style.display = 'flex';
    coinCountEl.textContent='6';
  }
});

// ----------------- COUPON APPLY -----------------
applyCouponBtn.addEventListener('click', async ()=>{
  const code = (applyCouponInput.value||'').trim().toUpperCase();
  if(!currentUid){ couponMsg.textContent='Login to apply coupon.'; return; }
  if(!code){ couponMsg.textContent='Enter a coupon code.'; return; }
  if(!validCoupons[code]){ couponMsg.textContent='Invalid coupon.'; return; }
  try{
    const coinsRef = ref(db,'users/'+currentUid+'/coins');
    await runTransaction(coinsRef,cur=> (cur||0)+validCoupons[code]);
    couponMsg.textContent = `Coupon applied! +${validCoupons[code]} coins.`;
    applyCouponInput.value='';
    await refreshUser();
  }catch(err){ console.error(err); couponMsg.textContent='Failed to apply coupon.'; }
});

// ----------------- STYLISH TEXT -----------------
const maps = {
  bold:{'a':'𝗮','b':'𝗯','c':'𝗰','d':'𝗱','e':'𝗲','f':'𝗳','g':'𝗴','h':'𝗵','i':'𝗶','j':'𝗷','k':'𝗸','l':'𝗹','m':'
    import { getAuth, GoogleAuthProvider, signInWithRedirect, getRedirectResult, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

/* ----------------- NEW STYLE FUNCTIONS ----------------- */
const styleFns = [
  t=>t,                       // normal
  t=>t.toUpperCase(),
  t=>t.toLowerCase(),
  t=>t.split('').reverse().join(''),             // reversed
  t=>t.split('').join(' '),                      // spaced
  t=>`★ ${t} ★`,                                 // star
  t=>`✧ ${t} ✧`,                                 // sparkle
  t=>`☾ ${t} ☽`,                                 // moon
  t=>`✿ ${t} ✿`,                                 // flower
  t=>`ღ ${t} ღ`,                                 // heart
  t=>`➳ ${t} ➳`,                                 // arrow
  t=>`♪ ${t} ♪`,                                 // music
  t=>`♛ ${t} ♛`,                                 // crown
  t=>t.replace(/[aeiou]/gi, c=>c.toUpperCase()), // vowels uppercase
  t=>t.replace(/[bcdfghjklmnpqrstvwxyz]/gi, c=>c.toUpperCase()), // consonants uppercase
  t=>t.split('').map(c=>c+'̴').join(''),        // glitch effect 1
  t=>t.split('').map(c=>'̵'+c).join(''),        // glitch effect 2
  t=>t.split('').map(c=>c+'͜').join(''),        // swirl effect
  t=>t.split('').map(c=>'~'+c+'~').join(''),    // tilde effect
  t=>t.split('').map(c=>'•'+c+'•').join(''),    // dot effect
  t=>t.split('').map(c=>c+'★').join(''),        // end star
  t=>t.split('').map(c=>'★'+c).join(''),        // start star
];
